(()=>{function d(s,p){let f="https",{domain:l}=p,i=null,a=null,r=null,c=null,m=null;function h(t){if(!t)return e=>e;let n=t.toUpperCase();return m&&clearInterval(m),m=setInterval(()=>{fetch(`${f}://${l}/?method=get&room=${n}`).then(e=>e.json()).then(e=>i.postMessage(e))},5e3),e=>{e&&fetch(`${f}://${l}/?method=send&room=${n}&data=${e}`)}}let I;return(async()=>{try{let t=await s(`https://${l}/`);I=n=>{if(!n)return o=>o;let e=n.toUpperCase(),g=0;return t.on("message",o=>{i.postMessage(JSON.parse(o))}),o=>{o&&t.send(`${e} ${o}`)}},a="socket"}catch(t){console.log(t),a="rest"}})(),{onUIMessage(t){let{roomId:n,data:e}=t;n!=c&&(c=n,a==="socket"?r=I(c):r=h(c)),r&&r(e)},connectPort(t){i=t}}}var u=d(io,{domain:"jstplayer.com"});chrome.runtime.onConnect.addListener(s=>{s.name==="jst"&&(u.connectPort(s),s.onMessage.addListener(u.onUIMessage))});})();
