(()=>{function I(s,h){let f="https",{domain:l}=h,a=null,i=null,r=null,c=null,m=null;function p(t){if(!t)return e=>e;let o=t.toUpperCase();return m&&clearInterval(m),m=setInterval(()=>{fetch(`${f}://${l}/?method=get&room=${o}`).then(e=>e.json()).then(e=>a.postMessage(e))},5e3),e=>{e&&fetch(`${f}://${l}/?method=send&room=${o}&data=${e}`)}}let u;return(async()=>{try{let t=await s(`https://${l}/`);u=o=>{if(!o)return n=>n;let e=o.toUpperCase(),g=0;return t.on("message",n=>{a.postMessage(JSON.parse(n))}),n=>{n&&t.send(`${e} ${n}`)}},i="socket"}catch(t){console.log(t),i="rest"}})(),{onUIMessage(t){let{roomId:o,data:e}=t;o!=c&&(c=o,i==="socket"?r=u(c):r=p(c)),r&&r(e)},connectPort(t){a=t}}}var d=I(io,{domain:"symwatch.herokuapp.com"});chrome.runtime.onConnect.addListener(s=>{s.name==="jst"&&(d.connectPort(s),s.onMessage.addListener(d.onUIMessage))});})();
