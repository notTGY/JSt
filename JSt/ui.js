(()=>{function A(t){let e,n;switch(t.dimensions){case void 0:case"normal":e=75,n=800;break;case"big":e=85,n=900;break;case"verybig":e=100,n=1e3}let i=.9,s=(a,u)=>`${a}{${Object.keys(u).map(p=>`${p}:${u[p]}`).join(";")}}`,d={".JSt-video-wrapper":{display:"flex","align-items":"center","justify-content":"center"},".JSt-video-wrapper>video":{width:"100%",height:"100%"},"#JSt-pill":{width:`${n}px`,height:`${2*e}px`,"border-radius":`${e}px`,position:"fixed",top:"50px",left:`calc(50vw - ${n/2}px)`,overflow:"hidden","z-index":100,color:"#b863de",background:"linear-gradient(155deg, #fbf3ff, #f4e0ff)","box-shadow":`1px 1px 15px 2px #f4e0ff,
        inset 4px 4px 15px 2px #d4c0df,
        inset -4px -4px 15px 2px #d0abdf`,opacity:i,animation:"jst-pill-appear 0.5s"},"#JSt-pill:hover":{opacity:1},".JSt-button-container":{"margin-top":0,"margin-bottom":0,"margin-left":`${e}px`,height:`${2*e}px`,width:`${n-2*e}px`,display:"flex","flex-direction":"row","align-items":"center","justify-content":"flex-start",background:"transparent","z-index":102},".JSt-form":{margin:0,display:"flex","align-items":"center","z-index":400},".JSt-button":{width:`${2*e}px`,height:`${2*e}px`,border:"0px",padding:"20px",color:"#b863de",background:"transparent","z-index":500,transition:"0.2s",opacity:i,cursor:"pointer"},".JSt-button-padding":{padding:"20px!important"},"#JSt-code-input":{width:`${4*e}px`,height:`${2*e}px`,border:"0px",padding:"0px","padding-bottom":`${e/2}px`,"padding-top":`${e/2}px`,background:"transparent","z-index":500,transition:"0.5s",opacity:i,color:"#b863de","font-weight":600,"font-family":"monospace","font-size":`${e}px`},"#JSt-code-input::placeholder":{color:"#b863de"},".JSt-button:hover":{color:"#a853ce",padding:"5px"},".JSt-button:active":{color:"#9843be",padding:"20px"},".JSt-version":{width:`${n-2*e}px`,height:`${2*e}px`,position:"relative",top:`-${2*e}px`,margin:"0 auto","z-index":102,display:"flex","flex-direction":"row","align-items":"flex-end","justify-content":"flex-end",color:"#b863de","font-family":"monospace","font-size":"0.6rem"},".JSt-iframe-button":{position:"absolute!important",background:"transparent",border:"2px solid #e090df","box-shadow":"0 0 10px 4px #e090df"},"#Jitsi-meet":{position:"fixed",top:"200px",left:"10px",width:"400px",height:"400px",border:"none",opacity:"0.6","border-radius":"10px","user-select":"none"},"#Jitsi-mover":{position:"fixed",top:"190px",left:"0px",width:"20px",height:"20px",background:"#fff",border:"none",opacity:.6,cursor:"move","border-radius":"5px"}},r=` ${Object.keys(d).map(a=>s(a,d[a])).join(" ")}
@keyframes jst-pill-appear{
  from {
    opacity: 0;
  }
  to {
    opacity: ${i};
  }
}`,o=document.createElement("style");o.innerHTML=r,document.head.append(o)}var J=A;var N='<svg viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 21s4.6429-7 13-7c8.3571 0 13 7 13 7s-4.6429 7-13 7c-8.3571 0-13-7-13-7Z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M23.5 1H1v40h40V18.5M27 1h14m0 0v14m0-14L27 15" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',I='<svg transform="scale(-1 1)" transform-origin="center" viewBox="0 0 128 128" fill="currentcolor"><path d="M106.9893 41.9164c-2.4458-2.028-4.6879-.712-6.1614.4555-7.6236 6.0377-14.0459 10.769-20.9298 15.9803-7.576 5.7354-15.4101 11.6664-23.8195 18.3933-6.3939 5.1146-7.8801 12.1272-4.0787 19.24 1.0626 2.3214 3.5564 4.3796 6.8445 5.6482a14.1974 14.1974 0 0 0 5.132 1.0006c4.5652 0 8.7756-2.4557 12.0024-7.1411 6.46-9.381 11.9193-17.6315 17.699-26.3667 4.5108-6.817 8.4793-13.2085 13.6394-20.8063 1.6433-2.4195 1.5177-4.8732-.328-6.4038ZM64.0024 38.076a49.1323 49.1323 0 0 1 18.5574 5.4495c.8494.4467 1.6888.923 2.5038 1.4237.8297-.653 1.6594-1.3108 2.4841-1.9637q5.037-3.9914 10.079-7.9729a62.6196 62.6196 0 0 0-9.1118-4.6982c-.6088-.2553-1.2225-.5057-1.841-.7413A63.0142 63.0142 0 0 0 1.0203 88.343H6.666a56.291 56.291 0 0 1 5.9894-21.2624 54.6615 54.6615 0 0 1 13.3043-16.7802A52.8275 52.8275 0 0 1 44.09 40.2607a51.036 51.036 0 0 1 19.9123-2.1846Zm62.9773 50.267q0-.6112-.0147-1.2224a4.4687 4.4687 0 0 0 .0098-.5155c-.0982-2.4449-.2504-4.9044-.5891-7.3297a62.0805 62.0805 0 0 0-11.6352-28.4694l-4.5952 6.77q-3.0781 4.5363-6.1956 9.1314a44.6276 44.6276 0 0 1 1.6005 4.4283 44.163 44.163 0 0 1 1.6446 17.2073Z"/></svg>',V='<svg viewBox="0 0 128 128" fill="currentcolor"><path d="M106.9893 41.9164c-2.4458-2.028-4.6879-.712-6.1614.4555-7.6236 6.0377-14.0459 10.769-20.9298 15.9803-7.576 5.7354-15.4101 11.6664-23.8195 18.3933-6.3939 5.1146-7.8801 12.1272-4.0787 19.24 1.0626 2.3214 3.5564 4.3796 6.8445 5.6482a14.1974 14.1974 0 0 0 5.132 1.0006c4.5652 0 8.7756-2.4557 12.0024-7.1411 6.46-9.381 11.9193-17.6315 17.699-26.3667 4.5108-6.817 8.4793-13.2085 13.6394-20.8063 1.6433-2.4195 1.5177-4.8732-.328-6.4038ZM64.0024 38.076a49.1323 49.1323 0 0 1 18.5574 5.4495c.8494.4467 1.6888.923 2.5038 1.4237.8297-.653 1.6594-1.3108 2.4841-1.9637q5.037-3.9914 10.079-7.9729a62.6196 62.6196 0 0 0-9.1118-4.6982c-.6088-.2553-1.2225-.5057-1.841-.7413A63.0142 63.0142 0 0 0 1.0203 88.343H6.666a56.291 56.291 0 0 1 5.9894-21.2624 54.6615 54.6615 0 0 1 13.3043-16.7802A52.8275 52.8275 0 0 1 44.09 40.2607a51.036 51.036 0 0 1 19.9123-2.1846Zm62.9773 50.267q0-.6112-.0147-1.2224a4.4687 4.4687 0 0 0 .0098-.5155c-.0982-2.4449-.2504-4.9044-.5891-7.3297a62.0805 62.0805 0 0 0-11.6352-28.4694l-4.5952 6.77q-3.0781 4.5363-6.1956 9.1314a44.6276 44.6276 0 0 1 1.6005 4.4283 44.163 44.163 0 0 1 1.6446 17.2073Z"/></svg>',H='<svg viewBox="0 0 32 32" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M2 20 L12 28 30 4" /></svg>',B='<svg fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#a)"><path d="M-.0814 10.7248a1 1 0 0 1 1.352-.4102l1.7635.9405a9.9579 9.9579 0 0 1 2.7153-5.0092c1.424-1.424 3.1735-2.3306 5.0091-2.7152l-.9419-1.7621a1 1 0 1 1 1.7636-.9433l1.3322 2.4918a9.97 9.97 0 0 1 6.9791 2.9288l.7071-.707a1.0002 1.0002 0 0 0 0-1.4143l-.7071-.707a1.0002 1.0002 0 0 1 .7071-1.7072 1 1 0 0 1 .7071.293l.7071.707a3 3 0 0 1 0 4.2426l-.7071.7072 1.4142 1.4142 2.1213-2.1214a1.0002 1.0002 0 0 1 1.7072.7072.9999.9999 0 0 1-.2929.707l-2.1214 2.1214 1.4143 1.4142.7071-.7071a3 3 0 0 1 4.2426 0l.7071.7071a1.0001 1.0001 0 0 1-1.4142 1.4142l-.7071-.7071a1.0001 1.0001 0 0 0-1.4142 0l-.7071.7071a10.0003 10.0003 0 0 1 0 14.1421 10 10 0 0 1-14.1422 0l-.7071.7072a1 1 0 0 0 0 1.4142l.7071.7071a.9997.9997 0 0 1 0 1.4142 1.0001 1.0001 0 0 1-1.4142 0l-.7071-.7071a3 3 0 0 1 0-4.2427l.7071-.7071-1.4142-1.4142-2.1213 2.1213a.9997.9997 0 0 1-1.4142 0 .9998.9998 0 0 1 0-1.4142l2.1213-2.1213-1.4142-1.4142-.7071.7071a3 3 0 0 1-4.2427 0l-.707-.7071a1 1 0 1 1 1.4141-1.4142l.7071.7071a1.0001 1.0001 0 0 0 1.4143 0l.707-.7071c-1.929-1.929-2.9047-4.452-2.9288-6.9792L.3287 12.0767a.9998.9998 0 0 1-.4101-1.3519Zm8.6592 9.6633 5.6568 5.6568a7.9998 7.9998 0 0 0 10.5642.6647L13.5275 15.4383l-4.9497 4.9498Zm6.364-6.364L26.213 25.2954a8.0004 8.0004 0 0 0-.6646-10.5642l-5.6569-5.6568-4.9497 4.9497Zm3.5355-6.364a7.9784 7.9784 0 0 0-6.1038-2.3306 7.9659 7.9659 0 0 0-5.21 2.3307 7.966 7.966 0 0 0-2.332 5.2113 7.9777 7.9777 0 0 0 2.332 6.1024L18.4774 7.6602Z" fill="#000"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h32v32H0z"/></clipPath></defs></svg>',P='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M18 8s6-6 9-3 2 7-3 11-8 5-10 1m0 7s-6 6-9 3-2-7 3-11 8-5 10-1"/></svg>',D=V,z=I,F=N,U=H,Z=B,O=P,G={speedUp:D,speedDown:z,jstBlack:F,checkmark:U,bug:Z,share:O},f=G;function b(){[...document.querySelectorAll("iframe")].forEach(e=>{let n=e.getBoundingClientRect();if(n&&n.width&&n.height){let i=document.createElement("button");i.classList="JSt-iframe-button",i.style.top=n.top,i.style.left=n.left,i.style.width=n.width,i.style.height=n.height,i.onclick=s=>{window.open(e.src),s.stopPropagation()},i.oncontextmenu=s=>(s.preventDefault(),i.remove(),0),e.parentElement.append(i)}})}function E(t){let e=t.querySelector("video");if(e)return e;let n=document.body.querySelectorAll("video"),i=document.querySelector("audio");return i||n[0]}function T(t){let e=document.querySelector("audio");if(e)return t(e);["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach(n=>document.addEventListener(n,t))}function S(t,e){!t||["playing","pause","ratechange","seeked"].forEach(n=>{t.addEventListener(n,e)})}var x=0;function L(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2}function y(t){let e=new Date().getTime();if(e-x<100)return!1;x=e;let n=e,i=L(t),s=t.currentTime,d=t.playbackRate,c={playing:i,vidCurTime:s,curTime:n,playbackRate:d};return JSON.stringify(c)}function M(t,e){let{vidCurTime:n,playbackRate:i,curTime:s,playing:d}=t;if(!s||s<x)return;let c=new Date().getTime();x=c;let r=(c-s)/1e3,o=n+i*r,a=L(e);d?(Math.abs(e.currentTime-o)>500&&(e.currentTime=o),a||(e.play(),e.currentTime!==o&&(e.currentTime=o))):(e.currentTime!==n&&(e.currentTime=n),a&&e.pause()),e.playbackRate!==t.playbackRate&&(e.playbackRate=t.playbackRate)}var W=(t,e)=>{let n={$el:t,elem:t.nodeName.toLowerCase()},i,s=()=>{t.innerHTML="",n=d({},e(),t)},d=(c,r,o)=>{Array.isArray(r)&&(r={children:r}),typeof r=="string"&&(r={innerText:r}),r.elem=r.elem||"span",!c||c.elem!==r.elem?(r.$el=document.createElement(r.elem),o.append(r.$el)):(r.$el=c.$el,r.cleanup=c.cleanup);let{$el:a,elem:u,children:p,cleanup:g,...h}=r;if(g)for(let l in g)a.removeEventListener(l.substring(2),r.cleanup[l]);r.cleanup={};for(let l in h)typeof(i=h[l])>"u"||(l.indexOf("on")!=0?a[l]=i:a.addEventListener(l.substring(2),r.cleanup[l]=m=>{h[l](m)}));return p?{...r,children:p.map((l,m)=>d(c&&c.children&&c.children[m],l,a))}:r};return s(),s},_={init:W};function k(t,e,n){let i=document.querySelector("#JSt-pill"),s=()=>({elem:"button",className:"JSt-button",innerHTML:f.speedUp,onclick:l=>{n.playbackRate<20&&(n.playbackRate+=.25)}}),d=()=>({elem:"button",className:"JSt-button",innerHTML:f.speedDown,onclick:l=>{n.playbackRate>.25&&(n.playbackRate-=.25)}}),c=()=>({elem:"button",className:"JSt-button",innerHTML:f.bug,onclick:l=>{window.open("https://jstplayer.com/feedback?from=app","_blank")}}),r=()=>({elem:"button",className:"JSt-button",innerHTML:f.share,onclick:l=>{let m=window.location;window.open(`https://jstplayer.com/watch?v=${m}`,"_blank")}}),o=()=>({elem:"form",className:"JSt-form",onsubmit:l=>{l.preventDefault();let m=document.querySelector("#JSt-code-input").value.toUpperCase();e(m);let v=document.querySelector("#Jitsi-mover");v&&(v.hidden=!1);let w=document.querySelector("#Jitsi-meet");w&&(w.hidden=!1,w.src=`https://meet.jit.si/JSt/${m}`),h()},children:[{elem:"input",minLength:6,maxLength:6,required:!0,autofocus:!0,id:"JSt-code-input",placeholder:"______",value:t()??""},{elem:"button",className:"JSt-button",innerHTML:f.checkmark}]}),a="default",u=()=>({elem:"button",className:"JSt-button JSt-button-padding",innerHTML:f.jstBlack,onclick:l=>{a==="default"?a="code":a==="code"&&(a="default"),h()}}),p=()=>{switch(a){case"default":return[u(),d(),s(),r()];case"code":return[u(),o()]}},g=()=>({elem:"section",children:[{elem:"div",className:"JSt-button-container",children:p()},{elem:"span",className:"JSt-version",innerHTML:`alpha ${20}`}]}),h=_.init(i,g)}var K=2e3,Y=!1;function C(t,e,n,i){if(!t)throw new Error("couldnt init on undefined elem");if(t.nodeName==="VIDEO"){let o=document.createElement("div");o.classList.add("JSt-video-wrapper"),t.parentNode.appendChild(o);let a=()=>{if(o.requestFullscreen)return o.requestFullscreen();if(o.mozRequestFullScreen)return o.mozRequestFullScreen();if(o.webkitRequestFullScreen)return o.webkitRequestFullScreen()},u=()=>{!o||(o.appendChild(t),window.removeEventListener("click",u),window.removeEventListener("keydown",u),setTimeout(a,200))};return window.addEventListener("click",u),window.addEventListener("keydown",u),0}if(Y){let o=document.createElement("iframe");o.id="Jitsi-meet",o.hidden=!0,o.allow="camera; microphone";let a=document.createElement("div");a.id="Jitsi-mover",a.hidden=!0,a.onmousedown=u=>{onmousemove=p=>{o.style.top=p.clientY+"px",o.style.left=p.clientX+"px",a.style.top=p.clientY-10+"px",a.style.left=p.clientX-10+"px"},onmouseup=p=>{onmousemove=null}},t.append(o),t.append(a)}let s=document.createElement("section");s.id="JSt-pill",t.append(s),s.onclick=o=>o.stopPropagation();function d(){s.hidden=!0}let c;function r(){c&&clearTimeout(c),c=setTimeout(d,K),s.hidden=!1}r(),document.addEventListener("click",r),document.addEventListener("mousedown",r),document.addEventListener("mousemove",r),document.addEventListener("keydown",r),k(e,n,i)}function $(){let t=document.querySelector("#JSt-pill");if(t&&t.parentNode)t.parentNode.removeChild(t);else return 0;let e=document.querySelector(".JSt-video-wrapper");e&&(e.parentNode.append(e.children.item(0)),e.remove())}function q(t){let e=null,n=null,i=null,s=()=>i;return{onIncomingMessage(d){M(d,n)},connectPort(d){if(e=d,window.JST)return;window.JST=1,J(t),b(),T(r=>{let o=document.querySelector("audio"),a;if(o)n=o,a=document.body;else{if(a=document.fullscreenElement,!a)return $();n=E(a)}S(n,()=>e.postMessage({roomId:i,data:y(n)})),C(a,s,p=>{i=p,S(n,()=>e.postMessage({roomId:i,data:y(n)}))},n)})}}}var X={dimensions:"normal",color:"trans","border-width":"4px"},j=q(X),R=chrome.runtime.connect({name:"jst"});R.onMessage.addListener(j.onIncomingMessage);j.connectPort(R);})();
